# TunaSim
Tunable Spectral Similarity

TunaSims are tuneable MSMS spectral similarity measures that are trained using gradient descent. Rather than select some particular vector similarity measure, we create a general measure skeleton (tunas.py) that contains common vector similarity measures in its function space, e.g. cosine or lorentzian similarity. With an input target library and set of query spectra, we fit function parameters against a loss function taking into account predicted similarity, and a binary indicator of spectral precursor molecule equivalence. In addition to producing better separation of true and false proposed matches, TunaSims can be ensembled to produce better results. We leverage the tunability of these functions by fitting on residuals of previously tuned functions in a fashion similar to gradient boosting (layers.py). Ensembled metrics designed to capture information that previous measures failed to produces superior results.

A simple gradient boosting classifier combines tuned similarity measures to produce superior results when compared to any individual function (layers.py). Additionally, a query adjustment layer predicts which queries are likely to contain a True positive match as top hit (layers.py), further improving performance. Combining these layers (networks.py) results in a custom deep learning architecture for predicting equivalence of MS2 query spectra against a library of prospective matches. This architecture is inspired by CNNs (flexible shape input), gradient boosting (ensembling of TunaSims) and utilizes gradient boosting sub models to achieve state of the art performance on library searches, a key work flow in mass spectrometry.

Further work could include generalizing this rough architecture to other problems involving tandem MS inputs. More to come.
